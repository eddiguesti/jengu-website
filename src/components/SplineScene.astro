---
/**
 * Spline Scene Component
 * Optimized for fastest possible load time with aggressive caching
 */
---

<canvas id="spline-canvas" class="spline-canvas"></canvas>

<script>
  import { Application } from '@splinetool/runtime';

  // Start immediately - no DOM ready wait
  const canvas = document.getElementById('spline-canvas') as HTMLCanvasElement;

  if (canvas) {
    // Create application instance immediately
    const app = new Application(canvas);

    // Set rendering options for better performance
    canvas.style.willChange = 'transform';

    // Load scene with aggressive timeout and no retries for fastest first load
    const sceneUrl = 'https://prod.spline.design/H0BsfAOW2BCmCUyJ/scene.splinecode';

    app.load(sceneUrl)
      .then(() => {
        // Scene loaded successfully
        const container = document.querySelector('.spline-container');
        if (container) {
          container.classList.add('loaded');
        }

        // Remove will-change after animation completes
        setTimeout(() => {
          canvas.style.willChange = 'auto';
        }, 1000);
      })
      .catch((error) => {
        console.error('Error loading Spline scene:', error);
      });
  }
</script>

<style>
  .spline-canvas {
    width: 100%;
    height: 100%;
    display: block;
    /* Hardware acceleration for better performance */
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
  }
</style>
