---
import BaseLayout from '../components/layout/BaseLayout.astro';
import { generateSEO } from '../lib/seo/metadata';
import { generateOrganizationSchema, generateBreadcrumbSchema } from '../lib/seo/jsonld';

const seo = generateSEO({
  title: 'Contact Us - Book Your Free AI Consultation',
  description: 'Schedule a free 30-minute consultation to discuss AI automation for your tourism business. Email us at info@jengu.ai or book a video call. Get expert advice on chatbots, automation & ROI.',
  canonical: `${Astro.site}contact/`,
  ogType: 'website'
});

const jsonLd = [
  generateOrganizationSchema(),
  generateBreadcrumbSchema([
    { name: 'Home', url: Astro.site?.href || '' },
    { name: 'Contact', url: `${Astro.site}contact/` }
  ])
];
---

<BaseLayout seo={seo} jsonLd={jsonLd}>
  <!-- Contact Section -->
  <section class="contact-section">
    <div class="contact-container">
      <!-- Contact Info -->
      <div class="contact-info">
        <div class="contact-card">
          <div class="contact-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <h3>Email Us</h3>
          <p>For general inquiries and support</p>
          <a href="mailto:info@jengu.ai">info@jengu.ai</a>
        </div>

        <div class="contact-card">
          <div class="contact-icon">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <h3>Book a Demo</h3>
          <p>Schedule a personalized 30-minute consultation to discuss your automation needs</p>
          <a href="#" onclick="openBookingModal(); return false;">Schedule Now →</a>
        </div>

        <div class="contact-card">
          <div class="contact-icon">
            <i class="fas fa-calculator"></i>
          </div>
          <h3>Calculate Your ROI</h3>
          <p>See your potential savings in 2 minutes</p>
          <a href="/calculator">Free ROI Analysis →</a>
        </div>
      </div>

      <!-- Contact Form -->
      <div class="contact-form-wrapper">
        <h2>Send Us a Message</h2>
        <p style="color: var(--gray); margin-bottom: 2rem;">Fill out the form below and we'll get back to you within 24 hours</p>

        <form id="contactForm" onsubmit="handleSubmit(event)">
          <div class="form-row">
            <div class="form-group">
              <label for="firstName">First Name *</label>
              <input type="text" id="firstName" name="firstName" required>
            </div>
            <div class="form-group">
              <label for="lastName">Last Name *</label>
              <input type="text" id="lastName" name="lastName" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="email">Email *</label>
              <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
              <label for="phone">Phone</label>
              <input type="tel" id="phone" name="phone">
            </div>
          </div>

          <div class="form-group">
            <label for="businessType">Business Type *</label>
            <select id="businessType" name="businessType" required>
              <option value="">Select your business type</option>
              <option value="hotel">Hotel</option>
              <option value="resort">Resort</option>
              <option value="campsite">Campsite/Holiday Park</option>
              <option value="bnb">B&B / Guesthouse</option>
              <option value="travel-agency">Travel Agency</option>
              <option value="tour-operator">Tour Operator</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="interest">What are you interested in? *</label>
            <select id="interest" name="interest" required>
              <option value="">Select a service</option>
              <option value="chatbot">AI Chatbots & Phone Bots</option>
              <option value="software">Custom Software Development</option>
              <option value="api">API Integrations</option>
              <option value="email">Email Automation</option>
              <option value="pricing">Dynamic Pricing</option>
              <option value="full">Complete Automation Suite</option>
              <option value="consultation">Just Exploring / Consultation</option>
            </select>
          </div>

          <div class="form-group">
            <label for="message">Tell us about your needs *</label>
            <textarea id="message" name="message" required placeholder="Describe your current challenges and what you're looking to achieve..."></textarea>
          </div>

          <button type="submit" class="submit-btn">
            <i class="fas fa-paper-plane"></i> Send Message
          </button>
        </form>
      </div>
    </div>
  </section>

  <!-- Booking CTA -->
  <section class="calendly-section">
    <div class="calendly-container">
      <h2>Prefer to Talk? <span class="gradient-text">Book a Call</span></h2>
      <p>
        Schedule a 30-minute video consultation with our team. We'll discuss your specific needs, walk through examples, and show you exactly how AI automation can transform your business.
      </p>
      <button onclick="openBookingModal()" class="calendly-btn">
        <i class="fas fa-video"></i> Book Your Free Consultation
      </button>
    </div>
  </section>

  <!-- Form Submission Script -->
  <script is:inline>
    async function handleSubmit(event) {
      event.preventDefault();

      const submitButton = event.target.querySelector('button[type="submit"]');
      const originalButtonText = submitButton.innerHTML;

      try {
        // Disable button and show loading state
        submitButton.disabled = true;
        submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

        // Get form data
        const formData = new FormData(event.target);
        const data = Object.fromEntries(formData);

        // Send to API
        const response = await fetch('/api/contact', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        const result = await response.json();

        if (!response.ok) {
          throw new Error(result.error || 'Failed to send message');
        }

        // Show success message
        alert('✅ ' + result.message);

        // Reset form
        event.target.reset();

      } catch (error) {
        console.error('Form submission error:', error);
        alert('❌ ' + (error.message || 'An error occurred. Please try again or email us directly at info@jengu.ai'));
      } finally {
        // Re-enable button
        submitButton.disabled = false;
        submitButton.innerHTML = originalButtonText;
      }
    }
  </script>

  <style>
    /* Contact Page - Start at top of viewport on desktop */
    @media (min-width: 769px) {
      .contact-section {
        padding-top: 100px !important;
        margin-top: 0 !important;
      }
    }
  </style>
</BaseLayout>
